=================================
Test of QR factorization routines
=================================
QR of Real matrix
=================
A = [[1.45728 1.30289 0.432204 1.28131 1.19487]
 [-1.13848 -0.505866 0.563233 0.00583875 0.284213]
 [1.12252 0.746416 0.917611 -0.0358695 -0.281477]
 [0.937431 -0.697447 -0.403519 -0.453088 1.51511]
 [0.308753 1.02252 0.457302 -1.72459 1.09403]]
Q = [[-0.612869 -0.340674 0.0527734 0.515203 -0.490014]
 [0.478793 -0.0591111 -0.697754 0.109107 -0.518168]
 [-0.472083 -0.0990368 -0.706926 -0.0667697 0.512959]
 [-0.394242 0.756361 -0.0955805 -0.331577 -0.391678]
 [-0.129848 -0.546403 0.0384052 -0.77991 -0.273584]]
R = [[-2.37781 -1.25088 -0.328697 -0.362986 -1.20272]
 [0 -1.57411 -0.826488 0.166322 0.152207]
 [0 0 -0.96274 0.0659751 -0.0390683]
 [0 0 0 2.15843 -0.690216]
 [0 0 0 0 -1.76991]]
norm(e) = 1.25823e-15

A = [[-0.516334 0.887216]
 [-1.96168 -1.63085]
 [-2.85784 -1.36627]
 [1.13228 -0.45695]]
Q = [[-0.140196 0.67525 -0.430337 0.582403]
 [-0.532638 -0.448697 -0.705827 -0.129523]
 [-0.775966 -0.0452517 0.562687 0.281445]
 [0.307438 -0.583661 0.00112218 0.751545]]
R = [[3.68295 1.66397]
 [0 1.65938]
 [0 0]
 [0 0]]
norm(e) = 4.61863e-16

A = [[0.35137 0.352447 1.11508 -0.804102]
 [0.552351 -1.02175 0.67581 -0.899812]]
Q = [[-0.536739 -0.843748]
 [-0.843748 0.536739]]
R = [[-0.65464 0.672924 -1.16872 1.19081]
 [0 -0.845787 -0.57811 0.195495]]
norm(e) = 5.55112e-17

QR of Real matrix with pivoting
===============================
A = [[0.173576 -0.518217 -1.70857 1.21513 -0.113386]
 [-0.970581 0.710777 0.134245 2.43424 -0.651321]
 [-0.346552 1.05022 0.0977357 -1.9921 -0.496171]
 [0.860294 -1.19285 0.0495035 -0.654304 -0.734627]
 [-0.837553 -0.882379 0.348021 1.19228 0.700967]]
Q = [[-0.334199 0.202132 -0.900095 -0.00180919 0.19308]
 [-0.669491 -0.474211 0.170986 -0.529934 0.129766]
 [0.547888 -0.432238 -0.155859 -0.191006 0.672468]
 [0.179953 0.631046 0.0910294 -0.745961 0.068215]
 [-0.327914 0.386286 0.357792 0.355283 0.699295]]
R = [[-3.63596 0.347417 0.429463 -0.159955 0.831373]
 [0 -1.98934 -0.285589 0.307599 0.864488]
 [0 0 1.67462 0.251951 -0.489536]
 [0 0 0 1.23718 -0.359091]
 [0 0 0 0 -0.852491]]
P = [[0 0 0 0 1]
 [0 1 0 0 0]
 [0 0 1 0 0]
 [1 0 0 0 0]
 [0 0 0 1 0]]

norm(e) = 1.57225e-15

A = [[-1.13133 1.69955]
 [-0.408242 -0.670984]
 [-1.37079 -0.933034]
 [-0.360927 0.328428]]
Q = [[-0.817971 -0.509231 -0.120709 -0.238823]
 [0.322935 -0.26254 -0.904924 -0.0888748]
 [0.449056 -0.800581 0.395555 -0.0309052]
 [-0.158068 -0.175574 -0.100392 0.966493]]
R = [[-2.07777 0.235044]
 [0 1.84409]
 [0 0]
 [0 0]]
P = [[0 1]
 [1 0]]

norm(e) = 2.28878e-16

A = [[-1.80882 -0.601921 0.0243746 -0.477814]
 [1.09812 0.716213 -0.42997 0.887189]]
Q = [[-0.854808 0.518945]
 [0.518945 0.854808]]
R = [[2.11605 0.868841 -0.243966 0.886202]
 [0 0.510417 -0.354893 0.299861]]
P = [[1 0 0 0]
 [0 0 0 1]
 [0 0 1 0]
 [0 1 0 0]]

norm(e) = 3.20014e-16

QR of Complex matrix
====================
A = [[0.770337+0.197172i -0.535805+0.546278i -0.266859-0.438964i -0.558091-0.0390739i -0.537047-0.479537i]
 [0.331977-0.702367i -0.11788-1.15986i 0.662834-0.648018i -0.276296-0.0400101i -0.238933-0.742285i]
 [0.0653018+0.0103309i -0.112724-1.15655i -0.953276+0.552194i 0.310217+1.42559i 0.518141-0.586608i]
 [0.604775-1.60556i 0.272566-0.548203i 0.260513+1.41633i -0.187267-0.253276i -1.18154+0.990668i]
 [-0.10322+1.13462i -0.171829+0.696077i -0.446256-0.266404i -0.245456+0.387019i 0.772273-0.484054i]]
Q = [[-0.329017-0.0842136i -0.475651+0.242009i 0.057908-0.327936i -0.456001+0.290364i -0.214939-0.387946i]
 [-0.14179+0.299987i -0.158991-0.490037i 0.289906-0.552813i 0.138897+0.152847i -0.0525969+0.435225i]
 [-0.0278909-0.0044124i -0.0780399-0.649626i -0.528628+0.300234i -0.0793121+0.39094i -0.129386-0.16014i]
 [-0.258304+0.68575i -0.0246278+0.0575i -0.0236818+0.339179i -0.490831-0.170716i 0.19717+0.185944i]
 [0.0440861-0.484607i -0.0470541+0.124671i -0.0552591+0.105888i -0.38248+0.299371i 0.176856+0.681174i]]
R = [[-2.34133+0i -0.983931-0.0911686i 0.873921-0.777106i -0.124542+0.107976i 1.26959+1.21538i]
 [0+0i 1.79093+0i 0.0113491+0.0571621i -0.580924+0.144283i 0.871145+0.711407i]
 [0+0i 0+0i 1.81928+0i 0.159607-1.12224i 0.287276-0.0743645i]
 [0+0i 0+0i 0+0i 1.07627+0i -0.340894-0.582023i]
 [0+0i 0+0i 0+0i 0+0i -0.224027+0i]]
norm(e) = 6.46922e-16

A = [[0.361024+0.924574i 0.0423066+0.0504556i]
 [-0.53522-0.0752561i 0.594774+0.783451i]
 [-0.149551-0.433852i -1.29434+0.061395i]
 [-0.547819-0.238739i 0.686734-0.559119i]]
Q = [[-0.26579-0.680682i 0.0722811-0.191469i 0.352758+0.195656i 0.501702+0.0985858i]
 [0.394035+0.0554044i -0.279538-0.347591i 0.486777+0.380463i -0.207349-0.466914i]
 [0.110101+0.319407i 0.674095+0.0394546i 0.604517-0.205634i 0.0363953+0.14438i]
 [0.403311+0.175762i -0.353799+0.421924i 0.114023-0.186681i 0.670955-0.072268i]]
R = [[-1.35831+0i 0.287977+0.36512i]
 [0+0i -1.79414+0i]
 [0+0i 0+0i]
 [0+0i 0+0i]]
norm(e) = 3.03812e-16

A = [[-0.526117+0.298154i 0.262918+0.361521i 0.908446+0.268456i -0.63648+0.150303i]
 [0.552488+0.0709776i -0.649466+0.0759357i -0.341267+0.521722i -0.46862-0.673068i]]
Q = [[-0.639907+0.362639i -0.192313+0.649637i]
 [0.671982+0.0863288i -0.590116+0.439034i]]
R = [[0.822178+0i -0.467015-0.219589i -0.668254-0.121176i 0.0887846-0.277201i]
 [0+0i 0.600893+0i 0.430134-0.799836i 0.201087+0.987503i]]
norm(e) = 5.61282e-16

QR of Complex matrix with pivoting
==================================
A = [[0.422776-0.540601i 0.793772-0.34618i 1.7408-1.0284i 0.453298-0.38094i -0.171737+0.0092065i]
 [0.670183-0.0664686i -0.913362-0.0919502i -0.381155+0.22656i 0.537534+0.0908027i -0.664608-0.712506i]
 [0.142414-0.889849i 0.70407-0.198383i 1.05736+0.407918i -0.783683-0.914798i 0.857883+0.791739i]
 [-0.132059-1.13866i 0.374691-0.795032i -1.49869+0.452239i 0.958468-1.33556i -0.0824094-0.188543i]
 [0.915771-0.17806i -0.433361+0.0785676i 1.37987-1.17081i -0.164031+1.46601i -0.720519-0.0950606i]]
Q = [[-0.517984+0.306005i -0.397172+0.510576i 0.0309951+0.331673i 0.201464-0.259342i 0.020696+0.0194294i]
 [0.113415-0.0674141i -0.200405-0.11536i 0.314296+0.455521i -0.303294+0.191033i 0.653739-0.258814i]
 [-0.314623-0.121378i 0.137558+0.445668i -0.409664-0.316479i -0.426032+0.38701i 0.26306-0.0165402i]
 [0.445944-0.134566i -0.224952+0.383251i -0.00503344+0.362372i -0.058197+0.45943i -0.383275+0.304696i]
 [-0.410587+0.348381i -0.044699-0.333274i 0.415613-0.103411i -0.21098+0.416434i -0.147623+0.416928i]]
R = [[-3.36072+0i 1.2463-0.713551i -0.0502389-0.0279239i -0.584429-0.28593i -0.332542-0.173113i]
 [0+0i -2.21695+0i 0.769323-0.285156i -1.33583+0.523527i -0.685726-0.808494i]
 [0+0i 0+0i -1.49526+0i 0.224504+0.00073883i -1.12303+0.273311i]
 [0+0i 0+0i 0+0i -1.17844+0i -0.130503+0.188536i]
 [0+0i 0+0i 0+0i 0+0i -0.664228+0i]]
P = [[0 0 0 1 0]
 [0 0 0 0 1]
 [1 0 0 0 0]
 [0 1 0 0 0]
 [0 0 1 0 0]]

norm(e) = 1.13676e-15

A = [[-0.755277+0.25492i 1.14943-0.222561i]
 [-1.9332+0.419168i -1.31105+0.032601i]
 [-0.11152+0.627468i 0.141455+1.22875i]
 [0.105255+1.20399i 1.21753+0.0954194i]]
Q = [[-0.298195+0.100647i 0.643655-0.220781i -0.0718862+0.25658i -0.468786-0.383606i]
 [-0.763257+0.165494i -0.278092-0.245661i 0.0574207-0.403138i 0.201138-0.214692i]
 [-0.04403+0.247734i 0.0265208+0.434739i 0.849061+0.0184867i -0.121033-0.105324i]
 [0.0415563+0.475355i 0.424384-0.171687i 0.0546229+0.197364i 0.702036+0.167155i]]
R = [[2.53283+0i 1.03504-0.521169i]
 [0+0i 2.18381+0i]
 [0+0i 0+0i]
 [0+0i 0+0i]]
P = [[1 0]
 [0 1]]

norm(e) = 3.24622e-16

A = [[-0.436073+0.160398i 0.928659+0.163573i -1.071-1.04443i -0.444762-0.401494i]
 [0.655289-0.453377i -1.15473-0.206023i -0.635071+1.01806i 0.403399+0.257781i]]
Q = [[-0.558476-0.544624i 0.148591+0.607791i]
 [-0.33116+0.530869i -0.700751+0.342724i]]
R = [[1.91771+0i -0.334688+1.09566i -0.30151-0.524807i 0.47031-0.317523i]
 [0+0i 0.97598+0i -0.581885+0.381996i -0.504446-0.10823i]]
P = [[0 0 1 0]
 [0 1 0 0]
 [1 0 0 0]
 [0 0 0 1]]

norm(e) = 5.55689e-16

